{"id":-1,"name":"Onboarding diagram","userId":-1,"createdAt":"","updatedAt":"","content":{"items":[{"uid":"lmXwSMhjqu","position":{"x":420,"y":640},"sizes":{"width":100,"height":25},"autoheight":true,"blockContent":{"text":"ブラウザ"},"nodeType":"text"},{"uid":"Gr5xhxDFsw","position":{"x":710,"y":760},"sizes":{"width":100,"height":46},"autoheight":true,"blockContent":{"text":"Express Server"},"nodeType":"text"},{"uid":"_Rc7u2scsa","position":{"x":420,"y":920},"sizes":{"width":100,"height":25},"autoheight":true,"blockContent":{"text":"ブラウザ"},"nodeType":"text"},{"uid":"ztb38FMk3W","position":{"x":710,"y":1050},"sizes":{"width":100,"height":46},"autoheight":true,"blockContent":{"text":"Express Server"},"nodeType":"text"},{"uid":"vCqe_DxBDr","position":{"x":350,"y":1290},"sizes":{"width":250,"height":109},"autoheight":true,"blockContent":{"text":"ブラウザ\n\nJavaScriptを実行してハイドレーションし、インタラクティブなReactアプリになる！"},"nodeType":"text"},{"uid":"918A3aih9n","position":{"x":420,"y":500},"sizes":{"width":400,"height":78},"autoheight":false,"blockContent":{"type":"doc","content":[{"type":"heading","attrs":{"level":2},"content":[{"type":"text","text":"ローカル開発時"}]}]},"nodeType":"block"},{"uid":"Mbay6n1hIx","position":{"x":1450,"y":460},"sizes":{"width":400,"height":119.5},"autoheight":true,"blockContent":{"type":"doc","content":[{"type":"heading","attrs":{"level":2},"content":[{"type":"text","text":"本番デプロイ時"}]},{"type":"paragraph","content":[{"type":"text","text":"※今回はVercelにデプロイ"}]}]},"nodeType":"block"},{"uid":"WBZf-cvxYJ","position":{"x":1720,"y":630},"sizes":{"width":100,"height":25},"autoheight":true,"blockContent":{"text":"ブラウザ"},"nodeType":"text"},{"uid":"N_rZYl0-ps","position":{"x":1430,"y":760},"sizes":{"width":100,"height":46},"autoheight":true,"blockContent":{"text":"Vercelの Server"},"nodeType":"text"},{"uid":"EMRvAhgaM4","position":{"x":1700,"y":900},"sizes":{"width":100,"height":25},"autoheight":true,"blockContent":{"text":"ブラウザ"},"nodeType":"text"},{"uid":"xitEt8fM_n","position":{"x":1420,"y":1040},"sizes":{"width":100,"height":46},"autoheight":true,"blockContent":{"text":"Vercelの Server"},"nodeType":"text"},{"uid":"odFFTol42v","position":{"x":1630,"y":1240},"sizes":{"width":240,"height":109},"autoheight":true,"blockContent":{"text":"ブラウザ\n\nJavaScriptを実行してハイドレーションし、インタラクティブなReactアプリになる！\n"},"nodeType":"text"},{"uid":"UyLZGHujsf","position":{"x":-150,"y":370},"sizes":{"width":400,"height":256},"autoheight":true,"blockContent":{"type":"doc","content":[{"type":"filePathNode","attrs":{"pathToFile":"","version":1},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"server.ts"}]},{"type":"paragraph","content":[{"type":"text","text":"app.listen()でブラウザからの受け付ける準備。サーバーを停止するまで継続的に動作する"}]},{"type":"codeBlock","attrs":{"language":"typescript","wrapCode":true},"content":[{"type":"text","text":"app.listen(3000, () => {\n  console.log('Server started: http://localhost:3000');\n});"}]}]},"nodeType":"block"},{"uid":"aZhB48AVvu","position":{"x":-140,"y":830},"sizes":{"width":400,"height":406.5},"autoheight":true,"blockContent":{"type":"doc","content":[{"type":"filePathNode","attrs":{"pathToFile":"","version":1},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"server.ts"}]},{"type":"filePathNode","attrs":{"pathToFile":"","version":1},"content":[{"type":"text","text":"dist/index.html（サーバーサイドレンダリング用のテンプレート）を書き換えてブラウザに返す"}]},{"type":"codeBlock","attrs":{"language":"typescript","wrapCode":true},"content":[{"type":"text","text":"const appHtml = renderToString(React.createElement(App, null));"}]},{"type":"codeBlock","attrs":{"language":"typescript","wrapCode":true},"content":[{"type":"text","text":"const template = fs.readFileSync(path.resolve(__dirname, '..', 'dist', 'index.html'), 'utf-8');\nconst html = template.replace('<div id=\"root\"></div>', `<div id=\"root\">${appHtml}</div>`);\n"}]}]},"nodeType":"block"},{"uid":"yoHwGAaRXs","position":{"x":-580,"y":1330},"sizes":{"width":530,"height":252.5},"autoheight":true,"blockContent":{"type":"doc","content":[{"type":"filePathNode","attrs":{"pathToFile":"dist/","version":1},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"dist/index.html"}]},{"type":"paragraph","content":[{"type":"text","text":"ブラウザ: HTMLを表示"}]},{"type":"codeBlock","attrs":{"language":"xml","wrapCode":true},"content":[{"type":"text","text":"<body>\n      <div id=\"root\">\n      <h1>Hello</h1>  <!-- ← サーバー側で書き換えられた内容 -->\n    </div>\n</body>"}]}]},"nodeType":"block"},{"uid":"xz2aFo-BKD","position":{"x":-570,"y":1650},"sizes":{"width":400,"height":221},"autoheight":true,"blockContent":{"type":"doc","content":[{"type":"filePathNode","attrs":{"pathToFile":"dist/","version":1},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"dist/index.html"}]},{"type":"paragraph","content":[{"type":"text","text":"ブラウザ：HTML内の<script>タグからJSファイルをリクエスト"}]},{"type":"codeBlock","attrs":{"language":"xml","wrapCode":true},"content":[{"type":"text","text":"<script type=\"module\" crossorigin src=\"/assets/main-5UgiTl1W.js\"></script>"}]}]},"nodeType":"block"},{"uid":"E73hqrlf70","position":{"x":-110,"y":1940},"sizes":{"width":400,"height":182.5},"autoheight":true,"blockContent":{"type":"doc","content":[{"type":"filePathNode","attrs":{"pathToFile":"","version":1},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"server.ts"}]},{"type":"paragraph","content":[{"type":"text","text":"Express Server: main-5UgiTl1W.js を配信"}]},{"type":"codeBlock","attrs":{"language":"typescript","wrapCode":true},"content":[{"type":"text","text":"app.use(express.static('dist'));"}]}]},"nodeType":"block"},{"uid":"PUIyJ_uTLy","position":{"x":-540,"y":2260},"sizes":{"width":430,"height":280.5},"autoheight":true,"blockContent":{"type":"doc","content":[{"type":"filePathNode","attrs":{"pathToFile":"src/","version":1},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"main.tsx"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"ブラウザ: JSを実行してハイドレーション"}]},{"type":"paragraph","content":[{"type":"text","text":"hydrateRoot();でハイドレーション実行"}]},{"type":"codeBlock","attrs":{"language":"typescript","wrapCode":true},"content":[{"type":"text","text":"import { hydrateRoot } from 'react-dom/client';\nimport App from './App';\n\nhydrateRoot(document.getElementById('root')!, <App />);"}]}]},"nodeType":"block"},{"uid":"3jO-M_UILE","position":{"x":-530,"y":2640},"sizes":{"width":400,"height":217.5},"autoheight":true,"blockContent":{"type":"doc","content":[{"type":"filePathNode","attrs":{"pathToFile":"src/","version":1},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"App.tsx"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"ブラウザ: インタラクティブなReactアプリになる"}]},{"type":"codeBlock","attrs":{"language":"typescript","wrapCode":true},"content":[{"type":"text","text":"export default function App() {\n  return <h1>Hello</h1>;\n}"}]}]},"nodeType":"block"},{"uid":"jZ4Hd_TdMH","position":{"x":-450,"y":710},"sizes":{"width":100,"height":25},"autoheight":true,"blockContent":{"text":"ブラウザ"},"nodeType":"text"},{"uid":"vkwLiXPOqM","position":{"x":1890,"y":560},"sizes":{"width":400,"height":536},"autoheight":true,"blockContent":{"type":"doc","content":[{"type":"filePathNode","attrs":{"pathToFile":"","version":1},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"vercel.json"}]},{"type":"paragraph","content":[{"type":"text","text":"server.ts からビルドされた server.jsを実行するように設定。つまりExpressと同じコードが実行される"}]},{"type":"codeBlock","attrs":{"language":"json","wrapCode":true},"content":[{"type":"text","text":"\"builds\": [\n  {\n    \"src\": \"dist-server/server.js\",\n    \"use\": \"@vercel/node\"\n  },\n  {\n    \"src\": \"dist/**\",\n    \"use\": \"@vercel/static\"\n  }\n],\n\"routes\": [\n  {\n    \"src\": \"/assets/(.*)\",\n    \"dest\": \"/dist/assets/$1\"\n  },\n  {\n    \"src\": \"/(.*)\",\n    \"dest\": \"dist-server/server.js\"\n  }\n]"}]}]},"nodeType":"block"},{"uid":"h7apynXPlF","position":{"x":920,"y":-50},"sizes":{"width":400,"height":277},"autoheight":true,"blockContent":{"content":[{"type":"filePathNode","attrs":{"pathToFile":"","version":1},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"package.json"}]},{"type":"codeBlock","attrs":{"language":"json","wrapCode":true},"content":[{"type":"text","text":"\"scripts\": {\n  \"dev\": \"vite\",\n  \"clean\": \"rm -rf dist dist-server\",\n  \"build\": \"vite build && vite build --config vite.server.config.ts\",\n  \"start\": \"node dist-server/server.js\",\n  \"vercel-build\": \"yarn build\"\n},"}]}]},"nodeType":"block"},{"uid":"RGXRBkDkoW","position":{"x":910,"y":350},"sizes":{"width":400,"height":260},"autoheight":false,"blockContent":{"type":"doc","content":[{"type":"heading","attrs":{"level":2},"content":[{"type":"text","text":"dist-server/server.js と"},{"type":"hardBreak"},{"type":"text","text":"dist/* を生成"}]},{"type":"paragraph","content":[{"type":"text","text":"dist-server/"}]},{"type":"paragraph","content":[{"type":"text","text":"│─ server.js  "}]},{"type":"paragraph","content":[{"type":"text","text":"dist/    "}]},{"type":"paragraph","content":[{"type":"text","text":"│─ index.html"}]},{"type":"paragraph","content":[{"type":"text","text":"│─ assets/main-5UgiTl1W.js"}]}]},"nodeType":"block"},{"uid":"HxrL04zX5a","position":{"x":981.7557757222115,"y":534.2034472436967},"sizes":{"width":100,"height":25},"autoheight":true,"blockContent":{"text":"Add Your Text"},"nodeType":"text"}],"configs":{"centerX":402.00259310997046,"centerY":90.3901569800017,"zoomLevel":0.27986845935384497},"arrowData":{"arrowsMap":{"arrow-point-bI0wBh3Ufk-bottom-point-PSPLIYKa9J-top":{"to":"point-PSPLIYKa9J-top","from":"point-bI0wBh3Ufk-bottom","label":"Normal Box","direction":"ft","selectable":true},"arrow-point-bI0wBh3Ufk-bottom-point-ytXK_ayIc1-top":{"to":"point-ytXK_ayIc1-top","from":"point-bI0wBh3Ufk-bottom","label":"Code Box","direction":"ft","selectable":true},"arrow-point-hyyRZE3E8u-right-point-6ZopTaEaDZ-left":{"to":"point-6ZopTaEaDZ-left","from":"point-hyyRZE3E8u-right","label":"call","direction":"ft","selectable":true}},"pointsMap":{"point-PSPLIYKa9J-top":{"x":805.9999797489683,"y":60,"id":"point-PSPLIYKa9J-top","direction":"top"},"point-ytXK_ayIc1-top":{"x":205.99999493724206,"y":60,"id":"point-ytXK_ayIc1-top","direction":"top"},"point-6ZopTaEaDZ-left":{"x":220,"y":605.9999898744841,"id":"point-6ZopTaEaDZ-left","direction":"left"},"point-hyyRZE3E8u-right":{"x":100,"y":606,"id":"point-hyyRZE3E8u-right","direction":"right"},"point-bI0wBh3Ufk-bottom":{"x":515.9999797489683,"y":-40,"id":"point-bI0wBh3Ufk-bottom","direction":"bottom"}},"edgesMap":{"edge-lmXwSMhjqu-lmXwSMhjqu-bottom-Gr5xhxDFsw-Gr5xhxDFsw-top":{"uid":"edge-lmXwSMhjqu-lmXwSMhjqu-bottom-Gr5xhxDFsw-Gr5xhxDFsw-top","fromNodeId":"lmXwSMhjqu","fromHandleId":"lmXwSMhjqu-bottom","toNodeId":"Gr5xhxDFsw","toHandleId":"Gr5xhxDFsw-top","direction":"ft","selectable":true,"type":"solid","content":{"label":"\"http://localhost:3000/ をください\""}},"edge-Gr5xhxDFsw-Gr5xhxDFsw-bottom-_Rc7u2scsa-_Rc7u2scsa-top":{"uid":"edge-Gr5xhxDFsw-Gr5xhxDFsw-bottom-_Rc7u2scsa-_Rc7u2scsa-top","fromNodeId":"Gr5xhxDFsw","fromHandleId":"Gr5xhxDFsw-bottom","toNodeId":"_Rc7u2scsa","toHandleId":"_Rc7u2scsa-top","direction":"ft","selectable":true,"type":"solid","content":{"label":"HTMLを生成して返す"}},"edge-_Rc7u2scsa-_Rc7u2scsa-bottom-ztb38FMk3W-ztb38FMk3W-top":{"uid":"edge-_Rc7u2scsa-_Rc7u2scsa-bottom-ztb38FMk3W-ztb38FMk3W-top","fromNodeId":"_Rc7u2scsa","fromHandleId":"_Rc7u2scsa-bottom","toNodeId":"ztb38FMk3W","toHandleId":"ztb38FMk3W-top","direction":"ft","selectable":true,"type":"solid","content":{"label":"\"hogehoge.js をください\""}},"edge-ztb38FMk3W-ztb38FMk3W-bottom-vCqe_DxBDr-vCqe_DxBDr-top":{"uid":"edge-ztb38FMk3W-ztb38FMk3W-bottom-vCqe_DxBDr-vCqe_DxBDr-top","fromNodeId":"ztb38FMk3W","fromHandleId":"ztb38FMk3W-bottom","toNodeId":"vCqe_DxBDr","toHandleId":"vCqe_DxBDr-top","direction":"ft","selectable":true,"type":"solid","content":{"label":"事前にビルドされたJSファイルを返す"}},"edge-WBZf-cvxYJ-WBZf-cvxYJ-bottom-N_rZYl0-ps-N_rZYl0-ps-top":{"uid":"edge-WBZf-cvxYJ-WBZf-cvxYJ-bottom-N_rZYl0-ps-N_rZYl0-ps-top","fromNodeId":"WBZf-cvxYJ","fromHandleId":"WBZf-cvxYJ-bottom","toNodeId":"N_rZYl0-ps","toHandleId":"N_rZYl0-ps-top","direction":"ft","selectable":true,"type":"solid","content":{"label":"https://projects.vercel.app/ をください"}},"edge-N_rZYl0-ps-N_rZYl0-ps-bottom-EMRvAhgaM4-EMRvAhgaM4-top":{"uid":"edge-N_rZYl0-ps-N_rZYl0-ps-bottom-EMRvAhgaM4-EMRvAhgaM4-top","fromNodeId":"N_rZYl0-ps","fromHandleId":"N_rZYl0-ps-bottom","toNodeId":"EMRvAhgaM4","toHandleId":"EMRvAhgaM4-top","direction":"ft","selectable":true,"type":"solid","content":{"label":"HTMLを生成して返す"}},"edge-EMRvAhgaM4-EMRvAhgaM4-bottom-xitEt8fM_n-xitEt8fM_n-top":{"uid":"edge-EMRvAhgaM4-EMRvAhgaM4-bottom-xitEt8fM_n-xitEt8fM_n-top","fromNodeId":"EMRvAhgaM4","fromHandleId":"EMRvAhgaM4-bottom","toNodeId":"xitEt8fM_n","toHandleId":"xitEt8fM_n-top","direction":"ft","selectable":true,"type":"solid","content":{"label":"\"hogehoge.js をください\""}},"edge-xitEt8fM_n-xitEt8fM_n-bottom-odFFTol42v-odFFTol42v-top":{"uid":"edge-xitEt8fM_n-xitEt8fM_n-bottom-odFFTol42v-odFFTol42v-top","fromNodeId":"xitEt8fM_n","fromHandleId":"xitEt8fM_n-bottom","toNodeId":"odFFTol42v","toHandleId":"odFFTol42v-top","direction":"ft","selectable":true,"type":"solid","content":{"label":"事前にビルドされたJSファイルを返す"}},"edge-aZhB48AVvu-aZhB48AVvu-bottom-yoHwGAaRXs-yoHwGAaRXs-top":{"uid":"edge-aZhB48AVvu-aZhB48AVvu-bottom-yoHwGAaRXs-yoHwGAaRXs-top","fromNodeId":"aZhB48AVvu","fromHandleId":"aZhB48AVvu-bottom","toNodeId":"yoHwGAaRXs","toHandleId":"yoHwGAaRXs-top","direction":"ft","selectable":true,"type":"solid","content":{"label":" 静的ファイル配信"}},"edge-yoHwGAaRXs-yoHwGAaRXs-bottom-xz2aFo-BKD-xz2aFo-BKD-top":{"uid":"edge-yoHwGAaRXs-yoHwGAaRXs-bottom-xz2aFo-BKD-xz2aFo-BKD-top","fromNodeId":"yoHwGAaRXs","fromHandleId":"yoHwGAaRXs-bottom","toNodeId":"xz2aFo-BKD","toHandleId":"xz2aFo-BKD-top","direction":"ft","selectable":true,"type":"solid","content":{"label":""}},"edge-xz2aFo-BKD-xz2aFo-BKD-bottom-E73hqrlf70-E73hqrlf70-top":{"uid":"edge-xz2aFo-BKD-xz2aFo-BKD-bottom-E73hqrlf70-E73hqrlf70-top","fromNodeId":"xz2aFo-BKD","fromHandleId":"xz2aFo-BKD-bottom","toNodeId":"E73hqrlf70","toHandleId":"E73hqrlf70-top","direction":"ft","selectable":true,"type":"solid","content":{"label":"リクエスト"}},"edge-E73hqrlf70-E73hqrlf70-bottom-PUIyJ_uTLy-PUIyJ_uTLy-top":{"uid":"edge-E73hqrlf70-E73hqrlf70-bottom-PUIyJ_uTLy-PUIyJ_uTLy-top","fromNodeId":"E73hqrlf70","fromHandleId":"E73hqrlf70-bottom","toNodeId":"PUIyJ_uTLy","toHandleId":"PUIyJ_uTLy-top","direction":"ft","selectable":true,"type":"solid","content":{"label":""}},"edge-PUIyJ_uTLy-PUIyJ_uTLy-bottom-3jO-M_UILE-3jO-M_UILE-top":{"uid":"edge-PUIyJ_uTLy-PUIyJ_uTLy-bottom-3jO-M_UILE-3jO-M_UILE-top","fromNodeId":"PUIyJ_uTLy","fromHandleId":"PUIyJ_uTLy-bottom","toNodeId":"3jO-M_UILE","toHandleId":"3jO-M_UILE-top","direction":"ft","selectable":true,"type":"solid","content":{"label":""}},"edge-UyLZGHujsf-UyLZGHujsf-bottom-jZ4Hd_TdMH-jZ4Hd_TdMH-top":{"uid":"edge-UyLZGHujsf-UyLZGHujsf-bottom-jZ4Hd_TdMH-jZ4Hd_TdMH-top","fromNodeId":"UyLZGHujsf","fromHandleId":"UyLZGHujsf-bottom","toNodeId":"jZ4Hd_TdMH","toHandleId":"jZ4Hd_TdMH-top","direction":"ft","selectable":true,"type":"solid","content":{"label":""}},"edge-h7apynXPlF-h7apynXPlF-bottom-RGXRBkDkoW-RGXRBkDkoW-top":{"uid":"edge-h7apynXPlF-h7apynXPlF-bottom-RGXRBkDkoW-RGXRBkDkoW-top","fromNodeId":"h7apynXPlF","fromHandleId":"h7apynXPlF-bottom","toNodeId":"RGXRBkDkoW","toHandleId":"RGXRBkDkoW-top","direction":"ft","selectable":true,"type":"solid","content":{"label":"ビルド"}},"edge-RGXRBkDkoW-RGXRBkDkoW-right-N_rZYl0-ps-N_rZYl0-ps-left":{"uid":"edge-RGXRBkDkoW-RGXRBkDkoW-right-N_rZYl0-ps-N_rZYl0-ps-left","fromNodeId":"RGXRBkDkoW","fromHandleId":"RGXRBkDkoW-right","toNodeId":"N_rZYl0-ps","toHandleId":"N_rZYl0-ps-left","direction":"ft","selectable":true,"type":"solid","content":{"label":"事前にデプロイ"}},"edge-RGXRBkDkoW-RGXRBkDkoW-left-Gr5xhxDFsw-Gr5xhxDFsw-top":{"uid":"edge-RGXRBkDkoW-RGXRBkDkoW-left-Gr5xhxDFsw-Gr5xhxDFsw-top","fromNodeId":"RGXRBkDkoW","fromHandleId":"RGXRBkDkoW-left","toNodeId":"Gr5xhxDFsw","toHandleId":"Gr5xhxDFsw-top","direction":"ft","selectable":true,"type":"solid","content":{"label":"事前にデプロイ"}},"edge-jZ4Hd_TdMH-jZ4Hd_TdMH-bottom-aZhB48AVvu-aZhB48AVvu-top":{"uid":"edge-jZ4Hd_TdMH-jZ4Hd_TdMH-bottom-aZhB48AVvu-aZhB48AVvu-top","fromNodeId":"jZ4Hd_TdMH","fromHandleId":"jZ4Hd_TdMH-bottom","toNodeId":"aZhB48AVvu","toHandleId":"aZhB48AVvu-top","direction":"ft","selectable":true,"type":"solid","content":{"label":"リクエスト"}}}}}}