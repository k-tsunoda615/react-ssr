import r from"express";import e from"compression";import o from"path";import{fileURLToPath as t}from"url";import m from"fs";import i from"react";import{renderToString as s}from"react-dom/server";import{StaticRouter as l}from"react-router-dom/server.js";import p from"./src/App.tsx";let c=t(import.meta.url),d=o.dirname(c),a=r(),f=process.env.PORT||3e3;a.use(e()),a.use(r.static(o.resolve(d,"dist")));let n=m.readFileSync(o.resolve(d,"dist","index.html"),"utf-8");a.get("*",(r,e)=>{let o=s(i.createElement(l,{location:r.url},i.createElement(p))),t=n.replace('<div id="root"></div>',`<div id="root">${o}</div>`);e.send(t)}),a.listen(f,()=>{console.log(`サーバーが起動しました: http://localhost:${f}`)});
